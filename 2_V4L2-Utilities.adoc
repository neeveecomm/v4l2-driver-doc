= V4L2-Utilities

== Packages and Libraries:
[cols="1,3", options="header"]
|===
| Package Name | Description

| v4l-utils
| Provides command-line tools like `v4l2-ctl` and `qv4l2` for managing V4L2 devices.

| libv4l
| User-space library offering APIs for video format conversion and device control.

| v4l2loopback
| Enables creation of virtual video devices for simulating or redirecting video streams.

| media-ctl
| Command-line tool for configuring complex video pipelines using the Media Controller API.

| uvcdynctrl
| Utility for accessing and modifying extended controls on UVC-compliant webcams.
|===

== Installing the Utilities:

To include all the packages into our image we need to modify *local.conf* or image *.bb* file

|===
|"IMAGE_INSTALL:append = "v4l-utils libv4l media-ctl v4l2loopback uvcdynctrl "
|===

Then build the image and flash it on the verdin board.

NOTE=>By default it is installed in multimedia image.

== Checking the device availability & its capability

* Boot and Verify

+
[source,shell]
----
$ v4l2-ctl --version
$ media-ctl -h
----

* Check video device nodes

+
[source,shell]
----
$ ls /dev/video*
----

+
Typical output:

+
[source,txt]
----
/dev/video0, /dev/video1 → V4L2 capture devices
/dev/media0, /dev/media1 → Media controller interface (for CSI/MIPI cameras)
----

* Identify devices with v4l2-ctl

+
`v4l2-ctl --list-devices`

*  Inspect Media Pipeline (For CSI/MIPI)

+
`media-ctl -p`

+
Outputs:

** Entities (camera sensor, CSI, MIPI, ISP)
** Links (between pipeline components)
** Pads and formats

== Using v4l2 and qv4l2

* Common v4l2 commands 

+
A powerful CLI utility to interact with V4L2 devices. Ideal for scripting, debugging, and headless systems.

+
[cols="1,3", options="header"]
|===
| Purpose | Command

| List video devices                    
| `v4l2-ctl --list-devices`

| Show device info                      
| `v4l2-ctl -d /dev/video0 --all`

| List supported formats                
| `v4l2-ctl -d /dev/video0 --list-formats-ext`

| Set resolution & pixel format         
| `v4l2-ctl -d /dev/video0 --set-fmt-video=width=1280,height=720,pixelformat=YUYV`

| Set camera control (e.g., brightness) 
| `v4l2-ctl -d /dev/video0 --set-ctrl brightness=120`

| Capture one frame to file             
| `v4l2-ctl -d /dev/video0 --stream-mmap --stream-count=1 --stream-to=frame.raw`

|===

* qv4l2-Qt-based GUI Tool

+
A graphical utility for easy testing and interaction with V4L2 devices (used when GUI is available).

+
`qv4l2`

+
Use on development boards with GUI-enabled Yocto image

+
*Features of qv4l2*

. Live camera preview
. Format selection (resolution, pixel format)
. Real-time adjustment of camera controls (e.g., focus, contrast)
. Useful for debugging without writing code